---
layout: mypost
title: Agentå¼€å‘â€”â€”â€”â€”åŸºç¡€å†…å®¹ï¼ˆåŸºæœ¬æ–¹å¼ã€æ¡†æ¶ã€å‘é‡æ•°æ®åº“ç­‰ï¼‰
categories: Agentå¼€å‘
address: æ­¦æ±‰ğŸ¯
extMath: true
show_footer_image: true
tags:
- æ¨¡å‹éƒ¨ç½²
description: æ™ºèƒ½ä½“ï¼ˆAgentï¼‰é€šè¿‡æ™ºèƒ½ä½“å¾ªç¯ï¼ˆAgent Loopï¼‰ä¸ç¯å¢ƒäº¤äº’ï¼Œé‡‡ç”¨ReActä¸Plan-and-SolveèŒƒå¼ï¼Œç»“åˆæ€è€ƒä¸è¡ŒåŠ¨å®Œæˆä»»åŠ¡ã€‚å¼€å‘å¯ä½¿ç”¨LangGraphã€LangChainç­‰æ¡†æ¶åŠCozeã€n8nã€difyç­‰ä½ä»£ç å¹³å°ã€‚å‘é‡æ•°æ®åº“å°†æ•°æ®è½¬åŒ–ä¸ºé«˜ç»´å‘é‡å­˜å‚¨ï¼Œæ”¯æŒé«˜æ•ˆç›¸ä¼¼æ€§æœç´¢ï¼Œä¸»æµç±»åˆ«åŒ…æ‹¬Milvusã€Chromaã€Pineconeï¼Œé€‚ç”¨äºæ–‡æœ¬ã€å›¾åƒç­‰æ•°æ®çš„è¯­ä¹‰æ£€ç´¢ã€‚
---

TODO:
- [x] 2025.11.01 è¡¥å……å®Œæ¯•åŸºæœ¬çš„æ¡†æ¶ï¼ˆè¿™ä¸ªå¯èƒ½éœ€è¦ä¸æ–­è¡¥å……ï¼Œå¯ä»¥å…ˆå»**äº†è§£**éƒ½æœ‰ä»€ä¹ˆå°±è¡Œï¼‰ï¼Œä»¥åŠå‘é‡æ•°æ®åº“åŸºæœ¬å†…å®¹ï¼ˆ**äº†è§£**éƒ½æœ‰å“ªäº›ï¼Œ**ç†Ÿæ‚‰**Chromaçš„ä½¿ç”¨ï¼Œæœ€å¥½æ˜¯äº†è§£å¦‚ä½•å°†å…¶å’ŒAPIçš„ä½¿ç”¨ç»“åˆï¼‰


## åŸºæœ¬æ¦‚å¿µ
> å¤§éƒ¨åˆ†å†…å®¹çš„åŸç†å†…å®¹éƒ½æ˜¯ç›´æ¥å‚è€ƒæ¥è‡ªï¼š[https://github.com/datawhalechina/hello-agents](https://github.com/datawhalechina/hello-agents)

### Agentè¿è¡Œæœºåˆ¶
æ™ºèƒ½ä½“[^1]å¹¶éä¸€æ¬¡æ€§å®Œæˆä»»åŠ¡ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªæŒç»­çš„å¾ªç¯ä¸ç¯å¢ƒè¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªæ ¸å¿ƒæœºåˆ¶è¢«ç§°ä¸º æ™ºèƒ½ä½“å¾ªç¯ (Agent Loop)
![](https://s2.loli.net/2025/11/11/wjJg7lPMS8DnBYG.webp)
æ¢è¨€ä¹‹ä¸€ä¸ªæœ€åŸºæœ¬çš„æ¡ˆä¾‹å°±æ˜¯ï¼šç”¨æˆ·é€šè¿‡è¾“å…¥ï¼ˆæ¯”å¦‚ï¼šä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿï¼‰ï¼ŒAgenté€šè¿‡thoughtåˆ†æä»»åŠ¡ï¼ˆéœ€è¦è°ƒç”¨ä»€ä¹ˆå·¥å…·ï¼Œè·å–åœ°ç†ä½ç½®ã€è·å–ä½ç½®å¤©æ°”ï¼‰ç„¶åå°†å¾—åˆ°çš„å†…å®¹å†è¾“å‡ºç»™ç”¨æˆ·ã€‚
### æ™ºèƒ½ä½“èŒƒå¼â€”â€”ReAct
é€šè¿‡å°†æ€è€ƒä¸è¡ŒåŠ¨ç»„åˆã€‚æ€è€ƒæŒ‡å¯¼è¡ŒåŠ¨ï¼Œè€Œè¡ŒåŠ¨çš„ç»“æœåˆåè¿‡æ¥ä¿®æ­£æ€è€ƒï¼Œå…¶å·¥ä½œæµç¨‹ä¸º:
![](https://s2.loli.net/2025/11/11/VBp73kqOhKCdP51.webp)
æ¢è¨€ä¹‹å°±æ˜¯Agentåœ¨æ¯ä¸€æ¬¡æ—¶é—´tè¿›è¡Œçš„ç­–ç•¥éƒ½ä¼šå»ç»“åˆä¹‹å‰æ‰€æœ‰çš„çš„â€œaction-observationâ€æ¥ç”Ÿæˆå½“å‰çš„thoughtå’Œactionå†å»ç”±environmentä¸­çš„å·¥å…·æ‰§è¡Œæ–°çš„actionã€‚ç›´åˆ°æ¨¡å‹åˆ¤æ–­è¿è¡Œç»“æŸã€‚
### æ™ºèƒ½ä½“èŒƒå¼â€”â€”Plan-and-Solve
å¯¹äºPlan-and-Solveç›´æ¥ä»»åŠ¡å¤„ç†è¿‡ç¨‹åˆ†ä¸ºä¸¤é˜¶æ®µï¼š1ã€è§„åˆ’ï¼ˆplanï¼‰ï¼›2ã€æ‰§è¡Œï¼ˆsolveï¼‰
![](https://s2.loli.net/2025/11/11/S5emRQbWgrYahjs.webp)
## Agentå¼€å‘
å°±ç›®å‰å¸‚é¢ä¸Šçš„æ¡†æ¶æœ‰å¾ˆå¤šå¦‚LangGraph/LangChainç­‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šçš„ä½ä»£ç å¹³å°ï¼ˆåŸºæœ¬ä¸Šå°±å’Œæ„å»ºæµç¨‹å›¾ä¸€æ ·ï¼‰å¦‚Coze[^7]ã€n8n[^8]ã€dify[^6]ç­‰ã€‚ä½†æ˜¯å¯¹äºæ„å»ºä¸€ä¸ªAgentä»ä»£ç è§’åº¦æ¥è¯´å¤æ‚åº¦ä¸æ˜¯å¾ˆé«˜ã€‚ä»¥æ¡†æ¶LangGraphä¸ºä¾‹è¿›è¡Œå¼€å‘ä¸€ä¸ªAgentã€‚**é¦–å…ˆç®€å•äº†è§£Langgraph**ï¼ŒæŠŠAI åº”ç”¨æ‹†æˆ èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼Œç”¨ è¾¹ï¼ˆEdgeï¼‰ æ§åˆ¶æµè½¬ï¼ŒçŠ¶æ€ï¼ˆStateï¼‰åœ¨æ•´ä¸ªå›¾ä¸­ä¼ é€’ã€‚æ ¸å¿ƒå°±æ˜¯3ä¸ªæ¦‚å¿µï¼š**1ã€node**ï¼šä¸€ä¸ªå¯æ‰§è¡Œçš„å‡½æ•°ï¼Œæ¥æ”¶ state â†’ è¿”å› state æ›´æ–°ï¼›**2ã€state**ï¼šæ•´ä¸ªå·¥ä½œæµçš„å…±äº«æ•°æ®ç»“æ„ï¼ˆå­—å…¸ï¼‰ï¼›**3ã€edge**ï¼šæ§åˆ¶æµï¼šæ™®é€šè¾¹ã€æ¡ä»¶è¾¹ã€å¾ªç¯è¾¹ï¼›æ¯”å¦‚è¯´ä¸€ä¸ªæœ€ç®€å•ä¾‹å­ï¼ˆLLMæŸ¥è¯¢å¤©æ°”ï¼‰ï¼š
```python
import os
import requests
from typing import TypedDict, Annotated, List
from langchain_openai import ChatOpenAI
from langchain_core.messages import HumanMessage, BaseMessage, ToolMessage, AIMessage
from langchain_core.tools import tool
from langgraph.graph import StateGraph, END
from langgraph.prebuilt import ToolNode

os.environ["DOUBAO_API_KEY"] = "xxxxxxxx"

# ================== 2. å¤©æ°” Tool ==================
@tool
def get_weather(city: str) -> str:
    """æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”ï¼ˆè¿”å›ä¸­æ–‡æè¿°ï¼‰"""
    # å¿ƒçŸ¥å¤©æ°” (å…è´¹ï¼Œæ³¨å†Œ https://www.seniverse.com/ è·å– key)
    API_KEY = "xxxxxx"
    url = f"https://api.seniverse.com/v3/weather/now.json"
    params = {
        "key": API_KEY,
        "location": city,
        "language": "zh-Hans",
        "unit": "c"
    }
    try:
        resp = requests.get(url, params=params, timeout=5)
        data = resp.json()
        if "results" in data:
            r = data["results"][0]
            loc = r["location"]["name"]
            weather = r["now"]["text"]
            temp = r["now"]["temperature"]
            return f"{loc} å½“å‰å¤©æ°”ï¼š{weather}ï¼Œæ¸©åº¦ {temp}â„ƒ"
        else:
            return f"æŠ±æ­‰ï¼Œæœªèƒ½æŸ¥è¯¢åˆ° {city} çš„å¤©æ°”ä¿¡æ¯ã€‚"
    except Exception as e:
        return f"å¤©æ°”æŸ¥è¯¢å‡ºé”™ï¼š{str(e)}"

tools = [get_weather]
tool_node = ToolNode(tools)

# ================== 3. çŠ¶æ€å®šä¹‰ =================
class AgentState(TypedDict):
    messages: Annotated[List[BaseMessage], "å¯¹è¯å†å²"]

# ================== 4. LLM åˆå§‹åŒ–ï¼ˆ==================
# 
llm = ChatOpenAI(
    model="doubao-seed-1-6-250615",  # ['doubao-seed-1-6-250615', 'doubao-seed-1-6-flash-250615', 'doubao-seed-1-6-250615', 'doubao-1-5-lite-32k-250115']
    api_key=os.getenv("DOUBAO_API_KEY"),  # ç”¨è±†åŒ… key
    base_url="https://ark.cn-beijing.volces.com/api/v3",  # è±†åŒ… base URL
    temperature=0.3,
    max_tokens=512,
)
llm_with_tools = llm.bind_tools(tools)

# ================== 5. Agent èŠ‚ç‚¹ ==================
def agent(state: AgentState) -> dict:
    """æ ¸å¿ƒ Agentï¼šæ ¹æ®å†å²å†³å®šæ˜¯å›å¤è¿˜æ˜¯è°ƒç”¨å·¥å…·"""
    messages = state["messages"]
    response = llm_with_tools.invoke(messages)
    return {"messages": [response]}

# ================== 6. æ¡ä»¶è·¯ç”± ==================
def should_continue(state: AgentState):
    """åˆ¤æ–­æœ€åä¸€æ¡æ¶ˆæ¯æ˜¯å¦åŒ…å« tool_calls"""
    last_msg = state["messages"][-1]
    if isinstance(last_msg, AIMessage) and getattr(last_msg, "tool_calls", None):
        return "tools"      # å»æ‰§è¡Œå·¥å…·
    return END              # ç›´æ¥ç»“æŸ

# ================== 7. æ„å»º Graph ==================
graph = StateGraph(AgentState)

graph.add_node("agent", agent)
graph.add_node("tools", tool_node)

graph.set_entry_point("agent")
graph.add_conditional_edges(
    "agent",
    should_continue,
    {
        "tools": "tools",
        END: END
    }
)
graph.add_edge("tools", "agent")   # å·¥å…·æ‰§è¡Œå®Œå†å› Agent

app = graph.compile()
# ================== 8. äº¤äº’å…¥å£ ==================
def ask_weather(question: str, thread_id: str = "default"):
    config = {"configurable": {"thread_id": thread_id}}
    result = app.invoke(
        {"messages": [HumanMessage(content=question)]},
        config
    )
    final_msg = [m for m in result["messages"] if isinstance(m, AIMessage)][-1]
    print(final_msg.content)

# if __name__ == "__main__":
#     ask_weather("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")
```

## å‘é‡æ•°æ®åº“
å‘é‡æ•°æ®åº“[^2][^3]æ˜¯ä¸€ç§å°†æ•°æ®å­˜å‚¨ä¸ºé«˜ç»´å‘é‡çš„æ•°æ®åº“ï¼Œé«˜ç»´å‘é‡æ˜¯ç‰¹å¾æˆ–å±æ€§çš„æ•°å­¦è¡¨ç¤ºã€‚æ¯ä¸ªå‘é‡éƒ½æœ‰ä¸€å®šæ•°é‡çš„ç»´åº¦ï¼Œæ ¹æ®æ•°æ®çš„å¤æ‚æ€§å’Œç²’åº¦ï¼Œå¯ä»¥ä»æ•°ååˆ°æ•°åƒä¸ç­‰ã€‚é€šå¸¸æ˜¯é€šè¿‡å¯¹åŸå§‹æ•°æ®(å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰)åº”ç”¨æŸç§è½¬æ¢æˆ–åµŒå…¥å‡½æ•°æ¥ç”Ÿæˆçš„ã€‚åµŒå…¥å‡½æ•°å¯ä»¥åŸºäºå„ç§æ–¹æ³•ï¼Œå¦‚æœºå™¨å­¦ä¹ æ¨¡å‹ã€è¯åµŒå…¥å’Œç‰¹å¾æå–ç®—æ³•ã€‚**ä¸»è¦ä¼˜ç‚¹æ˜¯**ï¼šå®ƒå…è®¸**åŸºäºæ•°æ®çš„å‘é‡è·ç¦»æˆ–ç›¸ä¼¼æ€§è¿›è¡Œå¿«é€Ÿå’Œå‡†ç¡®çš„ç›¸ä¼¼æ€§æœç´¢å’Œæ£€ç´¢**ã€‚è¿™æ„å‘³ç€ä¸ç”¨ä½¿ç”¨åŸºäºç²¾ç¡®åŒ¹é…æˆ–é¢„å®šä¹‰æ ‡å‡†æŸ¥è¯¢æ•°æ®åº“çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨å‘é‡æ•°æ®åº“æ ¹æ®è¯­ä¹‰æˆ–ä¸Šä¸‹æ–‡å«ä¹‰æŸ¥æ‰¾æœ€ç›¸ä¼¼æˆ–æœ€ç›¸å…³çš„æ•°æ®ã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´å°†æ–‡æœ¬/å›¾ç‰‡ç­‰è½¬åŒ–ä¸ºå‘é‡å½¢å¼å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”é€šè¿‡è®¡ç®—ç›¸ä¼¼åº¦æ–¹å¼è¿›è¡Œç´¢å¼•æ£€ç´¢ï¼‰
å‘é‡æ•°æ®åº“ç±»åˆ«ä¹Ÿæœ‰å¾ˆå¤š[^4]ï¼šMilvusã€Chromaã€Pineconeç­‰ã€‚ç›´æ¥ä½¿ç”¨Milvusæ•°æ®åº“ï¼šç›´æ¥åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæœ¬åœ°éƒ¨ç½²Milvusæ•°æ®åº“ï¼š
```bash
wget https://github.com/milvus-io/milvus/releases/download/v2.4.0/milvus-standalone-docker-compose.yml -O docker-compose.yml

# å¯åŠ¨æœåŠ¡ï¼ˆåå°è¿è¡Œï¼‰
docker compose up -d
# æ£€æŸ¥çŠ¶æ€ï¼ˆåº”çœ‹åˆ° 3 ä¸ªå®¹å™¨ï¼šmilvus-etcdã€milvus-minioã€milvus-standaloneï¼‰
docker compose ps # æ£€æŸ¥çŠ¶æ€
docker compose logs milvus-standalone # æŸ¥çœ‹æ—¥å¿—
docker compose down   # åœæ­¢
docker compose up -d  # é‡å¯
```
æœåŠ¡å™¨å®‰è£…å®Œæ¯•ç›´æ¥ç›´æ¥é€šè¿‡æœ¬åœ°è¿æ¥æ–¹å¼è¿›è¡Œè¿æ¥ï¼Œå¯¹äºæ•°æ®åº“ä¸€èˆ¬è€Œè¨€å°±æ˜¯3ä¸ªæ“ä½œï¼šå¢ã€åˆ ã€æŸ¥ã€æ”¹ã€‚Milvusä¸­4ç±»æ“ä½œ: [milvus_base_use.py](../../../code/Python/Agent/milvus_base_use.py)ï¼Œæœ¬åœ°è¿æ¥Milvusæ•°æ®åº“å¯ä»¥ç›´æ¥é€šè¿‡å·¥å…·ï¼š[Attu](https://github.com/zilliztech/attu)
> å®˜æ–¹åœ°å€ï¼š[https://milvus.io/docs/zh](https://milvus.io/docs/zh)

## é«˜æ•ˆAPI

| åºå·  | ç±»åˆ« | åœ°å€ |
|:----:|:----:|:----:|
|1     | æµè§ˆå™¨æœç´¢ï¼ˆGoogleï¼‰| [https://serpapi.com/](https://serpapi.com/) |

## å‚è€ƒ
[^1]: [https://github.com/datawhalechina/hello-agents](https://github.com/datawhalechina/hello-agents)
[^2]: [https://youssefh.substack.com/p/my-e-book-data-science-portfolio](https://youssefh.substack.com/p/my-e-book-data-science-portfolio)
[^3]: [https://www.nvidia.cn/glossary/vector-database/](https://www.nvidia.cn/glossary/vector-database/)
[^4]: [https://blog.csdn.net/BASK2312/article/details/138868768](https://blog.csdn.net/BASK2312/article/details/138868768)
[^5]: [https://milvus.io/docs/zh/quickstart.md](https://milvus.io/docs/zh/quickstart.md)
[^6]: [https://dify.ai/](https://dify.ai/)
[^7]: [https://www.coze.com/](https://www.coze.com/)
[^8]: [https://n8n.io/](https://n8n.io/)