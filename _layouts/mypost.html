<!DOCTYPE html>
<html lang="zh-CN">
{% include head.html -%}
<body>
{% include header.html -%}
{%- if page.path contains '_posts/' -%}
<div id="toc"></div>
{%- endif -%}
<div class="page page-post">
  <h1 class="title" id="{{ page.title }}">{{ page.title }}</h1>
  {% assign words = content | number_of_words %}
  {% assign minutes = words | divided_by: 100 | plus: 1 %}

  {% if page.date %}
  <div class="subtitle">
    <span>{{site.author}} 于 
      {{ page.date | date: "%Y-%m-%d" }} 
      在 {{ page.address }} 发布 
        ⏳ 预计阅读 {{ minutes }} 分钟
    </span>
    {% if page.url contains "TODO" %}
      <span style="color: red; font-weight: bold; font-size: large;">writing.....</span>
    {% endif %}
  </div>
  {% endif %}

  {% if page.description %}
    <div id="description-llm" style="font-family: 'Courier New', Courier, monospace; white-space: pre-wrap; font-size: 1rem; padding: 16px; border-left: 4px solid #4a90e2; background: #f8fafc; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); line-height: 1.6; color: #333;"></div>
    <script>
      const descriptionText = `🤖:` + `{{ page.description | strip_newlines | escape }}`;
      const descriptionEl = document.getElementById('description-llm');
      let index = 0;
      let isTyping = true;

      function typeWriter() {
        if (isTyping && index < descriptionText.length) {
          descriptionEl.textContent += descriptionText.charAt(index);
          index++;
          setTimeout(typeWriter, 10);
        } else {
          descriptionEl.style.borderLeftColor = '#2ecc71';
        }
      }

      function handleVisibilityChange() {
        if (document.visibilityState === 'hidden' && isTyping) {
          isTyping = false;
          descriptionEl.textContent = descriptionText; // Render full text immediately
          descriptionEl.style.borderLeftColor = '#2ecc71';
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        descriptionEl.style.opacity = '0';
        descriptionEl.style.transition = 'opacity 0.5s ease-in';
        setTimeout(() => {
          descriptionEl.style.opacity = '1';
          typeWriter();
        }, 200);
      });

      document.addEventListener("visibilitychange", handleVisibilityChange);
    </script>
  {% endif %}

    
  <!-- Lightbox CSS -->
  <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/lightbox2/2.11.3/js/lightbox.min.js" type="application/javascript"></script>
  <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lightbox2/2.11.3/css/lightbox.min.css" type="text/css" rel="stylesheet" />
  <div class="post page-post">
    <!-- 处理内容中的图片 -->
    {% assign content_with_images = content 
      | replace: '<img', '<img loading="lazy" data-lightbox="gallery" class="content-image" alt="Image"'
      | replace: 'alt=""', 'alt="image"' %}
  
    {{ content_with_images }}
  </div>
  
  <!-- Prism 样式与插件 -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/themes/prism.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/plugins/line-numbers/prism-line-numbers.css" rel="stylesheet">

  <!-- Prism 核心与语言组件 -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/components/prism-javascript.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/components/prism-python.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/components/prism-markup.min.js"></script>

  <!-- Prism 插件 -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.26.0/plugins/previewers/prism-previewers.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function() {

      // 手动高亮（如果页面加载时代码动态插入，也可以用 Prism.highlightAll()）
      Prism.highlightAll();
    });
  </script>


  <!-- 在文章内容下方添加图片 -->
  {% if page.show_footer_image %}
  <div style="text-align: center; margin-top: 20px;">
    <img 
      src="https://s2.loli.net/2025/04/29/ntFU5SIfNCeK2Hy.png"
      alt="Footer Image" 
      style="max-width: 70%; height: auto;"
    >
  </div>
  {% endif %}

  <!-- 添加分享按钮 -->
  <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <div class="share-buttons">
    <!-- 微博 -->
    <button class="share-button" onclick="shareOnSocial('weibo')">
      <i class="fab fa-weibo"></i>
    </button>

    <!-- QQ -->
    <button class="share-button" onclick="shareOnSocial('qq')">
      <i class="fab fa-qq"></i>
    </button>

    <!-- 微信 -->
    <button class="share-button" onclick="shareOnWeChat()">
      <i class="fab fa-weixin"></i>
    </button>

    <!-- Facebook -->
    <button class="share-button" onclick="shareOnSocial('facebook')">
      <i class="fab fa-facebook-f"></i>
    </button>

    <!-- Twitter -->
    <button class="share-button" onclick="shareOnSocial('twitter')">
      <i class="fab fa-twitter"></i>
    </button>

    <!-- LinkedIn -->
    <button class="share-button" onclick="shareOnSocial('linkedin')">
      <i class="fab fa-linkedin-in"></i>
    </button>

    <!-- Reddit -->
    <button class="share-button" onclick="shareOnSocial('reddit')">
      <i class="fab fa-reddit-alien"></i>
    </button>
  </div>

  <div class="navigation-buttons">
    {% if page.previous.url %}
      <a href="{{ page.previous.url | relative_url }}" class="nav-button previous" title="{{ page.previous.title }}">
        <i class="fas fa-arrow-left"></i> {{ page.previous.title }}
      </a>
    {% else %}
      <span class="nav-button previous disabled">
        <i class="fas fa-arrow-left"></i> 没有上一篇文章
      </span>
    {% endif %}
  
    {% if page.next.url %}
      <a href="{{ page.next.url | relative_url }}" class="nav-button next" title="{{ page.next.title }}">
        {{ page.next.title }} <i class="fas fa-arrow-right"></i>
      </a>
    {% else %}
      <span class="nav-button next disabled">
        没有下一篇文章 <i class="fas fa-arrow-right"></i>
      </span>
    {% endif %}
  </div>

  <!-- <div id="vcomments"></div> -->
  <!-- <div id="vcomments" style="position: relative;">
    <div id="loading" style="text-align:center; padding: 20px;">评论加载中，请稍候...</div>
  </div>
  <script src="https://unpkg.com/valine@1.5.1/dist/Valine.min.js"></script>
  <script>
    new Valine({
      el: '#vcomments',
      appId: 'zTnWHiKFvCX4R30VQ4qyOjE0-MdYXbMMI',
      appKey: 'Icb1EA8yfNGBNuwOhTqTAagZ',
      serverURLs: 'https://ztnwhikf.api.lncldglobal.com',
      path: window.location.pathname,
      placeholder: '欢迎留言(无法评论/看不到评论请打开VPN)评论需要输入名称和邮箱',
      avatar: 'identicon',
      visitor: true, 
      highlight: true,
      recordIP: true,
      pageSize: 10,
      requiredFields: ['nick', 'mail']
    });
  </script> -->
<div id="tcomment"></div>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Dynamically load KaTeX CSS
    const katexCSS = document.createElement('link');
    katexCSS.rel = 'stylesheet';
    katexCSS.href = 'https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css';
    katexCSS.integrity = 'sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X';
    katexCSS.crossOrigin = 'anonymous';
    document.head.appendChild(katexCSS);

    // Dynamically load KaTeX JS
    const katexJS = document.createElement('script');
    katexJS.src = 'https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js';
    katexJS.integrity = 'sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4';
    katexJS.crossOrigin = 'anonymous';
    katexJS.defer = true;
    document.head.appendChild(katexJS);

    // Dynamically load KaTeX auto-render
    const katexAutoRender = document.createElement('script');
    katexAutoRender.src = 'https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js';
    katexAutoRender.integrity = 'sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa';
    katexAutoRender.crossOrigin = 'anonymous';
    katexAutoRender.defer = true;
    document.head.appendChild(katexAutoRender);

    // Dynamically load Twikoo JS
    const twikooJS = document.createElement('script');
    twikooJS.src = 'https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/twikoo/1.4.18/twikoo.min.js';
    document.head.appendChild(twikooJS);

    // Initialize Twikoo after scripts are loaded
    twikooJS.onload = () => {
      twikoo.init({
        envId: 'https://meek-halva-a18f24.netlify.app/.netlify/functions/twikoo',
        el: '#tcomment',
        katex: {
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false },
            { left: '\\(', right: '\\)', display: false },
            { left: '\\[', right: '\\]', display: true }
          ],
          throwOnError: false
        },
        markdown: {
          enable: true,
          toc: true,
          hljs: {
            enable: true,
            style: 'github'
          },
          mathjax: true,
          lazyLoad: true
        },
        editor: {
          mode: 'tab',
          preview: true,
          height: '200px',
          placeholder: '✨ 支持Markdown语法：**加粗**、`代码`、[链接]()、> 引用等...'
        },
        lang: 'zh-CN',
        path: window.location.pathname,
        avatar: 'retro',
        meta: ['nick', 'mail', 'link'],
        pageSize: 15,
        maxLength: 2000,
        emojiCDN: 'https://cdn.bootcdn.net/ajax/libs/twemoji/14.0.2/svg/',
        commentCount: true,
        requiredFields: ['nick', 'mail']
      });
    };
  });
</script>

</div>
{% include footer.html -%}
{% include script.html -%}

<!-- Font Awesome 图标（确保引入） -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- 目录样式 -->
<style>
  #toc {
    position: fixed;
    top: 100px;
    left: 20px;
    width: 180px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
    background: #f8f8f8;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    font-size: 0.9em;
    z-index: 10;
    transition: all 0.3s ease;
  }

  #toc.collapsed {
    width: auto;
    padding: 0;
    background: transparent;
    box-shadow: none;
    overflow: visible;
  }

  #toc.collapsed .toc-header,
  #toc.collapsed .toc-title,
  #toc.collapsed .toc-list {
    display: none;
  }

  /* 透明浮动汉堡按钮 */
  .toc-toggle-floating {
    position: fixed;
    top: 100px; /* 可自定义位置 */
    left: 20px;
    background: transparent;
    border: none;
    font-size: 1.6em;
    cursor: pointer;
    padding: 8px;
    z-index: 1000;
  }

  .toc-toggle-floating i {
    color: rgba(0, 0, 0, 0.2); /* 半透明三条线 */
  }

  .toc-toggle-floating:hover i {
    color: rgba(0, 123, 255, 0.5);
  }

  .toc-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }

  .toc-title {
    font-size: 1.1em;
    font-weight: bold;
    color: #333;
  }

  .toc-toggle {
    background: none;
    border: none;
    font-size: 1.1em;
    cursor: pointer;
    color: #333;
    padding: 0;
  }

  .toc-toggle:hover {
    color: #007bff;
  }

  .toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .toc-list li {
    margin: 5px 0;
  }

  .toc-list a {
    text-decoration: none;
    color: #333;
    transition: color 0.2s;
    display: block;
    padding: 2px 0;
  }

  .toc-list a:hover {
    color: #007bff;
  }

  .toc-list ul {
    padding-left: 15px;
  }

  .toc-list a.active {
    color: #007bff;
    font-weight: bold;
  }

  @media (max-width: 768px) {
    #toc {
      position: static;
      width: 100%;
      max-height: none;
      margin: 20px 0;
    }

    .toc-toggle-floating {
      top: auto;
      left: 10px;
      bottom: 20px;
    }
  }
</style>

<!-- 目录脚本 -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const toc = document.getElementById('toc');
    if (!toc) return;

    const content = document.querySelector('.post.page-post');
    if (!content) return;

    const headings = content.querySelectorAll('h2, h3, h4, h5, h6');
    if (headings.length === 0) {
      toc.style.display = 'none';
      return;
    }

    // 创建目录头部
    const tocHeader = document.createElement('div');
    tocHeader.className = 'toc-header';

    const tocTitle = document.createElement('span');
    tocTitle.className = 'toc-title';
    tocTitle.textContent = '目录';

    const tocToggle = document.createElement('button');
    tocToggle.className = 'toc-toggle';
    tocToggle.innerHTML = '<i class="fas fa-times"></i>';

    tocHeader.appendChild(tocTitle);
    tocHeader.appendChild(tocToggle);
    toc.appendChild(tocHeader);

    const tocList = document.createElement('ul');
    tocList.className = 'toc-list';

    headings.forEach((heading, index) => {
      if (!heading.id) {
        heading.id = 'heading-' + index;
      }

      const listItem = document.createElement('li');
      const link = document.createElement('a');
      link.href = '#' + heading.id;
      link.textContent = heading.textContent || '无标题';
      link.setAttribute('data-target-id', heading.id);
      listItem.appendChild(link);

      let level = parseInt(heading.tagName.replace('H', '')) - 2;
      let currentList = tocList;

      for (let i = 0; i < level; i++) {
        let lastLi = currentList.lastElementChild;
        if (!lastLi || !lastLi.querySelector('ul')) {
          const newUl = document.createElement('ul');
          newUl.className = 'toc-list';
          lastLi?.appendChild(newUl);
          currentList = newUl;
        } else {
          currentList = lastLi.querySelector('ul');
        }
      }
      currentList.appendChild(listItem);
    });

    toc.appendChild(tocList);

    // 透明汉堡按钮
    const floatingToggle = document.createElement('button');
    floatingToggle.className = 'toc-toggle-floating';
    floatingToggle.innerHTML = '<i class="fas fa-bars"></i>';
    document.body.appendChild(floatingToggle);
    floatingToggle.style.display = 'none';

    function toggleTOC() {
      toc.classList.toggle('collapsed');
      const isCollapsed = toc.classList.contains('collapsed');
      floatingToggle.style.display = isCollapsed ? 'block' : 'none';
    }

    tocToggle.addEventListener('click', toggleTOC);
    floatingToggle.addEventListener('click', toggleTOC);

    // 平滑滚动
    toc.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('data-target-id');
        const target = document.getElementById(targetId);
        if (target) {
          const headerHeight = document.querySelector('header')?.offsetHeight || 0;
          window.scrollTo({
            top: target.offsetTop - headerHeight - 20,
            behavior: 'smooth'
          });
        }
      });
    });

    // 高亮当前章节
    window.addEventListener('scroll', function () {
      let fromTop = window.scrollY + 100;
      let activeSet = false;
      headings.forEach(heading => {
        if (heading.offsetTop <= fromTop && !activeSet) {
          toc.querySelectorAll('a').forEach(link => link.classList.remove('active'));
          const link = toc.querySelector(`a[data-target-id="${heading.id}"]`);
          if (link) {
            link.classList.add('active');
            activeSet = true;
          }
        }
      });
      if (!activeSet) {
        toc.querySelectorAll('a').forEach(link => link.classList.remove('active'));
      }
    });

    // 避免 footer 遮挡
    const footer = document.querySelector('footer');
    const tocHeight = toc.offsetHeight;
    window.addEventListener('scroll', function () {
      const footerTop = footer ? footer.getBoundingClientRect().top : Infinity;
      const windowHeight = window.innerHeight;
      if (footerTop < windowHeight + tocHeight) {
        toc.style.top = `${footerTop - tocHeight - 20}px`;
      } else {
        toc.style.top = '100px';
      }
    });
  });
</script>



<script defer src="https://cloud.umami.is/script.js" data-website-id="b1118f16-642d-4b6b-99b0-fb2b4b34134c"></script>
<script src="https://analytics.ahrefs.com/analytics.js" data-key="4/nmCEy0+wcsPpIqB0+afg" async></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.url | absolute_url }}"
  },
  "headline": "{{ page.title }}",
  "description": "{{ page.description | default: page.title | strip_html | strip_newlines | truncate: 160 }}",
  "author": {
    "@type": "Person",
    "name": "HuangJie"
  },
  "publisher": {
    "@type": "Person",
    "name": "HuangJie",
    "url": "https://www.big-yellow-j.top/pages/about.html"
  },
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  "dateModified": "{% if page.last_modified_at %}{{ page.last_modified_at | date_to_xmlschema }}{% else %}{{ page.date | date_to_xmlschema }}{% endif %}",
  "inLanguage": "zh-CN"
}
</script>
</body>
</html>